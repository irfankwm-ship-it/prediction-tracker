<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prediction Tracker | Know What Matters</title>
    <meta name="description" content="Public accountability tracker for Canadian Intelligence Briefing predictions. Verified outcomes, Brier scores, and transparent methodology.">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

    <style>
        :root {
            --navy: #1e3a5f;
            --orange: #D97638;
            --green: #10b981;
            --red: #dc2626;
            --gold: #ca8a04;
            --gray-50: #f8fafc;
            --gray-100: #f1f5f9;
            --gray-200: #e2e8f0;
            --gray-400: #94a3b8;
            --gray-600: #475569;
            --gray-800: #1e293b;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--gray-50);
            color: var(--gray-800);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header */
        header {
            background: linear-gradient(135deg, var(--navy) 0%, #2c5282 100%);
            color: white;
            padding: 40px 0;
            margin-bottom: 40px;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }

        .brand {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .brand-logo {
            width: 60px;
            height: 60px;
            background: white;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            color: var(--navy);
            font-size: 24px;
        }

        .brand-text h1 {
            font-size: 24px;
            font-weight: 800;
            margin-bottom: 4px;
        }

        .brand-text p {
            font-size: 14px;
            opacity: 0.85;
        }

        .header-stats {
            display: flex;
            gap: 30px;
        }

        .header-stat {
            text-align: center;
        }

        .header-stat-value {
            font-size: 32px;
            font-weight: 800;
        }

        .header-stat-label {
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
            opacity: 0.85;
        }

        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            border-left: 4px solid var(--navy);
        }

        .stat-card.accuracy {
            border-left-color: var(--green);
        }

        .stat-card.brier {
            border-left-color: var(--orange);
        }

        .stat-card.pending {
            border-left-color: var(--gold);
        }

        .stat-card-label {
            font-size: 13px;
            color: var(--gray-600);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
        }

        .stat-card-value {
            font-size: 36px;
            font-weight: 800;
            color: var(--navy);
        }

        .stat-card-sub {
            font-size: 13px;
            color: var(--gray-400);
            margin-top: 4px;
        }

        /* Filters */
        .filters {
            display: flex;
            gap: 12px;
            margin-bottom: 24px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 10px 20px;
            border: 2px solid var(--gray-200);
            background: white;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .filter-btn:hover {
            border-color: var(--navy);
        }

        .filter-btn.active {
            background: var(--navy);
            color: white;
            border-color: var(--navy);
        }

        .filter-btn .count {
            background: var(--gray-100);
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 12px;
            margin-left: 8px;
        }

        .filter-btn.active .count {
            background: rgba(255,255,255,0.2);
        }

        /* Predictions List */
        .predictions-list {
            display: flex;
            flex-direction: column;
            gap: 16px;
            margin-bottom: 60px;
        }

        .prediction-card {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            border-left: 4px solid var(--gray-400);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .prediction-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .prediction-card.correct {
            border-left-color: var(--green);
        }

        .prediction-card.incorrect {
            border-left-color: var(--red);
        }

        .prediction-card.pending {
            border-left-color: var(--gold);
        }

        .prediction-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
            flex-wrap: wrap;
            gap: 12px;
        }

        .prediction-meta {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
        }

        .prediction-id {
            font-family: monospace;
            font-size: 12px;
            background: var(--gray-100);
            padding: 4px 10px;
            border-radius: 4px;
            color: var(--gray-600);
        }

        .prediction-domain {
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--orange);
        }

        .prediction-confidence {
            font-size: 12px;
            font-weight: 700;
            padding: 4px 12px;
            border-radius: 20px;
            background: var(--navy);
            color: white;
        }

        .prediction-status {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
            font-weight: 600;
        }

        .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
        }

        .status-dot.correct { background: var(--green); }
        .status-dot.incorrect { background: var(--red); }
        .status-dot.pending { background: var(--gold); }

        .prediction-text {
            font-size: 16px;
            font-weight: 600;
            color: var(--gray-800);
            margin-bottom: 12px;
            line-height: 1.5;
        }

        .prediction-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 16px;
            margin-bottom: 12px;
        }

        .prediction-detail {
            font-size: 13px;
        }

        .prediction-detail-label {
            font-weight: 600;
            color: var(--gray-600);
            margin-bottom: 4px;
        }

        .prediction-detail-value {
            color: var(--gray-800);
        }

        .prediction-dates {
            display: flex;
            gap: 24px;
            font-size: 13px;
            color: var(--gray-600);
            padding-top: 12px;
            border-top: 1px solid var(--gray-100);
        }

        .prediction-outcome {
            margin-top: 16px;
            padding: 16px;
            background: var(--gray-50);
            border-radius: 8px;
        }

        .outcome-label {
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
        }

        .outcome-label.correct { color: var(--green); }
        .outcome-label.incorrect { color: var(--red); }

        .outcome-text {
            font-size: 14px;
            color: var(--gray-800);
        }

        /* Methodology Section */
        .methodology {
            background: white;
            border-radius: 12px;
            padding: 32px;
            margin-bottom: 40px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .methodology h2 {
            font-size: 20px;
            color: var(--navy);
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 3px solid var(--orange);
        }

        .methodology-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 24px;
        }

        .methodology-item h3 {
            font-size: 14px;
            font-weight: 700;
            color: var(--navy);
            margin-bottom: 8px;
        }

        .methodology-item p {
            font-size: 14px;
            color: var(--gray-600);
        }

        /* Footer */
        footer {
            background: var(--navy);
            color: white;
            padding: 40px 0;
            text-align: center;
        }

        footer p {
            opacity: 0.85;
            font-size: 14px;
        }

        footer a {
            color: var(--orange);
            text-decoration: none;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                text-align: center;
            }

            .header-stats {
                justify-content: center;
            }

            .prediction-header {
                flex-direction: column;
            }

            .prediction-dates {
                flex-direction: column;
                gap: 8px;
            }
        }

        /* Loading State */
        .loading {
            text-align: center;
            padding: 60px;
            color: var(--gray-400);
        }

        .loading::after {
            content: '';
            display: inline-block;
            width: 24px;
            height: 24px;
            border: 3px solid var(--gray-200);
            border-top-color: var(--navy);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-left: 12px;
            vertical-align: middle;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px;
            color: var(--gray-400);
        }

        .empty-state h3 {
            font-size: 18px;
            margin-bottom: 8px;
            color: var(--gray-600);
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <div class="brand">
                    <div class="brand-logo">KM</div>
                    <div class="brand-text">
                        <h1>Prediction Tracker</h1>
                        <p>Know What Matters | Canadian Intelligence Briefing</p>
                    </div>
                </div>
                <div class="header-stats">
                    <div class="header-stat">
                        <div class="header-stat-value" id="total-predictions">--</div>
                        <div class="header-stat-label">Predictions</div>
                    </div>
                    <div class="header-stat">
                        <div class="header-stat-value" id="header-accuracy">--%</div>
                        <div class="header-stat-label">Accuracy</div>
                    </div>
                    <div class="header-stat">
                        <div class="header-stat-value" id="header-brier">--</div>
                        <div class="header-stat-label">Brier Score</div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <main class="container">
        <!-- Stats Cards -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-card-label">Total Predictions</div>
                <div class="stat-card-value" id="stat-total">--</div>
                <div class="stat-card-sub">Since January 2026</div>
            </div>
            <div class="stat-card accuracy">
                <div class="stat-card-label">Accuracy Rate</div>
                <div class="stat-card-value" id="stat-accuracy">--%</div>
                <div class="stat-card-sub" id="stat-accuracy-sub">-- correct of -- evaluated</div>
            </div>
            <div class="stat-card brier">
                <div class="stat-card-label">Brier Score</div>
                <div class="stat-card-value" id="stat-brier">--</div>
                <div class="stat-card-sub">Lower is better (0 = perfect)</div>
            </div>
            <div class="stat-card pending">
                <div class="stat-card-label">Awaiting Evaluation</div>
                <div class="stat-card-value" id="stat-pending">--</div>
                <div class="stat-card-sub" id="stat-next-due">Next due: --</div>
            </div>
        </div>

        <!-- Filters -->
        <div class="filters">
            <button class="filter-btn active" data-filter="all">
                All<span class="count" id="count-all">0</span>
            </button>
            <button class="filter-btn" data-filter="pending">
                Pending<span class="count" id="count-pending">0</span>
            </button>
            <button class="filter-btn" data-filter="correct">
                Correct<span class="count" id="count-correct">0</span>
            </button>
            <button class="filter-btn" data-filter="incorrect">
                Incorrect<span class="count" id="count-incorrect">0</span>
            </button>
        </div>

        <!-- Predictions List -->
        <div class="predictions-list" id="predictions-list">
            <div class="loading">Loading predictions</div>
        </div>

        <!-- Methodology -->
        <div class="methodology">
            <h2>Our Methodology</h2>
            <div class="methodology-grid">
                <div class="methodology-item">
                    <h3>Falsifiable Predictions</h3>
                    <p>Every prediction includes specific criteria for what would prove it correct or incorrect. No vague forecasts.</p>
                </div>
                <div class="methodology-item">
                    <h3>Confidence Levels</h3>
                    <p>We assign probability estimates (50-95%) to each prediction, enabling calibration tracking over time.</p>
                </div>
                <div class="methodology-item">
                    <h3>Brier Score</h3>
                    <p>We calculate Brier scores (0-1 scale) to measure prediction accuracy. Scores below 0.25 indicate good calibration.</p>
                </div>
                <div class="methodology-item">
                    <h3>Public Accountability</h3>
                    <p>All predictions are published before their due date. Outcomes are documented transparently, including our failures.</p>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <p><strong>Know What Matters</strong> | Portfolio Company of Aerial Capital Inc.</p>
            <p style="margin-top: 12px;">
                <a href="#">Subscribe to Daily Briefing</a> &nbsp;|&nbsp;
                <a href="#">Twitter</a> &nbsp;|&nbsp;
                <a href="#">LinkedIn</a>
            </p>
            <p style="margin-top: 20px; opacity: 0.6; font-size: 12px;">
                Last updated: <span id="last-updated">--</span>
            </p>
        </div>
    </footer>

    <script>
        // Predictions data - loaded from JSON file
        let predictions = [];

        async function loadPredictions() {
            try {
                const response = await fetch('predictions.json');
                predictions = await response.json();
                renderAll();
            } catch (error) {
                console.error('Failed to load predictions:', error);
                document.getElementById('predictions-list').innerHTML = `
                    <div class="empty-state">
                        <h3>Unable to load predictions</h3>
                        <p>Please check back later.</p>
                    </div>
                `;
            }
        }

        function calculateStats() {
            const total = predictions.length;
            const evaluated = predictions.filter(p => p.outcome !== 'pending');
            const correct = predictions.filter(p => p.outcome === 'correct');
            const incorrect = predictions.filter(p => p.outcome === 'incorrect');
            const pending = predictions.filter(p => p.outcome === 'pending');

            const accuracy = evaluated.length > 0
                ? (correct.length / evaluated.length * 100).toFixed(0)
                : '--';

            // Calculate Brier score
            let brierScore = '--';
            if (evaluated.length > 0) {
                let brierSum = 0;
                evaluated.forEach(p => {
                    const outcome = p.outcome === 'correct' ? 1 : 0;
                    const confidence = p.confidence / 100;
                    brierSum += Math.pow(confidence - outcome, 2);
                });
                brierScore = (brierSum / evaluated.length).toFixed(3);
            }

            // Find next due date
            const pendingSorted = pending
                .filter(p => p.due_date)
                .sort((a, b) => new Date(a.due_date) - new Date(b.due_date));
            const nextDue = pendingSorted.length > 0
                ? new Date(pendingSorted[0].due_date).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })
                : '--';

            return {
                total,
                evaluated: evaluated.length,
                correct: correct.length,
                incorrect: incorrect.length,
                pending: pending.length,
                accuracy,
                brierScore,
                nextDue
            };
        }

        function renderStats() {
            const stats = calculateStats();

            // Header stats
            document.getElementById('total-predictions').textContent = stats.total;
            document.getElementById('header-accuracy').textContent = stats.accuracy + '%';
            document.getElementById('header-brier').textContent = stats.brierScore;

            // Cards
            document.getElementById('stat-total').textContent = stats.total;
            document.getElementById('stat-accuracy').textContent = stats.accuracy + '%';
            document.getElementById('stat-accuracy-sub').textContent =
                `${stats.correct} correct of ${stats.evaluated} evaluated`;
            document.getElementById('stat-brier').textContent = stats.brierScore;
            document.getElementById('stat-pending').textContent = stats.pending;
            document.getElementById('stat-next-due').textContent = `Next due: ${stats.nextDue}`;

            // Filter counts
            document.getElementById('count-all').textContent = stats.total;
            document.getElementById('count-pending').textContent = stats.pending;
            document.getElementById('count-correct').textContent = stats.correct;
            document.getElementById('count-incorrect').textContent = stats.incorrect;

            // Last updated
            document.getElementById('last-updated').textContent =
                new Date().toLocaleDateString('en-US', {
                    year: 'numeric', month: 'long', day: 'numeric',
                    hour: '2-digit', minute: '2-digit'
                });
        }

        function renderPredictions(filter = 'all') {
            const container = document.getElementById('predictions-list');

            let filtered = predictions;
            if (filter !== 'all') {
                filtered = predictions.filter(p => p.outcome === filter);
            }

            if (filtered.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <h3>No predictions found</h3>
                        <p>No predictions match this filter.</p>
                    </div>
                `;
                return;
            }

            // Sort by date, newest first
            filtered.sort((a, b) => new Date(b.created_date) - new Date(a.created_date));

            container.innerHTML = filtered.map(p => `
                <div class="prediction-card ${p.outcome}">
                    <div class="prediction-header">
                        <div class="prediction-meta">
                            <span class="prediction-id">${p.id}</span>
                            <span class="prediction-domain">${p.domain}</span>
                            <span class="prediction-confidence">${p.confidence}% confidence</span>
                        </div>
                        <div class="prediction-status">
                            <span class="status-dot ${p.outcome}"></span>
                            ${p.outcome.charAt(0).toUpperCase() + p.outcome.slice(1)}
                        </div>
                    </div>

                    <div class="prediction-text">${p.prediction}</div>

                    <div class="prediction-details">
                        <div class="prediction-detail">
                            <div class="prediction-detail-label">Verification Criteria</div>
                            <div class="prediction-detail-value">${p.verification || 'Specific criteria defined'}</div>
                        </div>
                        <div class="prediction-detail">
                            <div class="prediction-detail-label">Falsification Criteria</div>
                            <div class="prediction-detail-value">${p.falsification || 'Specific criteria defined'}</div>
                        </div>
                    </div>

                    <div class="prediction-dates">
                        <span><strong>Created:</strong> ${new Date(p.created_date).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}</span>
                        <span><strong>Due:</strong> ${new Date(p.due_date).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}</span>
                        ${p.evaluated_date ? `<span><strong>Evaluated:</strong> ${new Date(p.evaluated_date).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}</span>` : ''}
                    </div>

                    ${p.outcome !== 'pending' ? `
                        <div class="prediction-outcome">
                            <div class="outcome-label ${p.outcome}">${p.outcome === 'correct' ? 'Prediction Correct' : 'Prediction Incorrect'}</div>
                            <div class="outcome-text">${p.outcome_notes || 'Outcome documented.'}</div>
                        </div>
                    ` : ''}
                </div>
            `).join('');
        }

        function renderAll() {
            renderStats();
            renderPredictions('all');
        }

        // Filter button handlers
        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                renderPredictions(btn.dataset.filter);
            });
        });

        // Load on page load
        loadPredictions();
    </script>
</body>
</html>
